<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.3.0"><link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/green/pace-theme-minimal.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script><script class="next-config" data-name="main" type="application/json">{"hostname":"alphax.top","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":false,"color":"#37c6c0","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":"waline","storage":true,"lazyload":false,"nav":null,"activeClass":"waline"},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"æœç´¢...","empty":"æ²¡æœ‰æ‰¾åˆ°ä»»ä½•æœç´¢ç»“æœï¼š${query}","hits_time":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰","hits":"æ‰¾åˆ° ${hits} ä¸ªæœç´¢ç»“æœ"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script><meta name="description" content="â€‹"><meta property="og:type" content="article"><meta property="og:title" content="Serveræ­å»ºè¿‡ç¨‹-8.Dockerä¸ªäººå¿ƒå¾—"><meta property="og:url" content="https://alphax.top/f0de0769/index.html"><meta property="og:site_name" content="AlphaUnkX."><meta property="og:description" content="â€‹"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2025-08-06T14:16:39.000Z"><meta property="article:modified_time" content="2025-09-06T16:59:10.572Z"><meta property="article:author" content="AlphaUnkX"><meta property="article:tag" content="Server"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://alphax.top/f0de0769/"><script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://alphax.top/f0de0769/","path":"f0de0769/","title":"Serveræ­å»ºè¿‡ç¨‹-8.Dockerä¸ªäººå¿ƒå¾—"}</script><script class="next-config" data-name="calendar" type="application/json">""</script><title>Serveræ­å»ºè¿‡ç¨‹-8.Dockerä¸ªäººå¿ƒå¾— | AlphaUnkX.</title><link rel="dns-prefetch" href="waline.alphax.top"><noscript><link rel="stylesheet" href="/css/noscript.css"></noscript><link rel="alternate" href="/atom.xml" title="AlphaUnkX." type="application/atom+xml"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage" class="use-motion"><div class="headband"></div><main class="main"><div class="column"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ " role="button"><span class="toggle-line"></span> <span class="toggle-line"></span> <span class="toggle-line"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><i class="logo-line"></i><p class="site-title">AlphaUnkX.</p><i class="logo-line"></i></a></div><div class="site-nav-right"><div class="toggle popup-trigger" aria-label="æœç´¢" role="button"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul class="main-menu menu"><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>å…³äº</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a></li><li class="menu-item menu-item-guestbook"><a href="/guestbook/" rel="section"><i class="fa fa-comment fa-fw"></i>ç•™è¨€æ¿</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>æœç´¢</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" maxlength="80" placeholder="æœç´¢..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close" role="button"><i class="fa fa-times-circle"></i></span></div><div class="search-result-container no-result"><div class="search-result-icon"><i class="fa fa-spinner fa-pulse fa-5x"></i></div></div></div></div></header><aside class="sidebar"><div class="sidebar-inner sidebar-nav-active sidebar-toc-active"><ul class="sidebar-nav"><li class="sidebar-nav-toc">æ–‡ç« ç›®å½•</li><li class="sidebar-nav-overview">ç«™ç‚¹æ¦‚è§ˆ</li></ul><div class="sidebar-panel-container"><div class="post-toc-wrap sidebar-panel"><div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Docker%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-text">1.Dockerçš„åŸºæœ¬ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-docker-pull"><span class="nav-text">1.docker pull</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-docker-images%EF%BC%88%E7%AD%89%E5%90%8C%E4%BA%8Edocker-image-ls%EF%BC%89"><span class="nav-text">2.docker imagesï¼ˆç­‰åŒäºdocker image lsï¼‰</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-docker-tag"><span class="nav-text">3.docker tag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-docker-run"><span class="nav-text">4.docker run</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person"><p class="site-author-name" itemprop="name">AlphaUnkX</p><div class="site-description" itemprop="description"></div></div><div class="links-of-author animated"><span class="links-of-author-item"><a href="https://github.com/GeekBookx" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;GeekBookx" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="https://weibo.com/u/5997832003" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;5997832003" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a> </span><span class="links-of-author-item"><a href="https://x.com/ATHEXScorez1" title="Twitter â†’ https:&#x2F;&#x2F;x.com&#x2F;ATHEXScorez1" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a> </span><span class="links-of-author-item"><a href="https://www.youtube.com/channel/UCXvPanS6EaMCtI6ZburcmLw" title="YouTube â†’ https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCXvPanS6EaMCtI6ZburcmLw" rel="noopener me" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a> </span><span class="links-of-author-item"><a href="https://bgm.tv/user/721785" title="Bangumi â†’ https:&#x2F;&#x2F;bgm.tv&#x2F;user&#x2F;721785" rel="noopener me" target="_blank"><i class="fab fa-bangumi fa-fw"></i>Bangumi</a> </span><span class="links-of-author-item"><a href="https://www.zhihu.com/people/windows-32" title="çŸ¥ä¹ â†’ https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;windows-32" rel="noopener me" target="_blank"><i class="fab fa-zhihu1 fa-fw"></i>çŸ¥ä¹</a> </span><span class="links-of-author-item"><a href="https://space.bilibili.com/110924426" title="Bilibili â†’ https:&#x2F;&#x2F;space.bilibili.com&#x2F;110924426" rel="noopener me" target="_blank"><i class="fab fa-bilibili fa-fw"></i>Bilibili</a> </span><span class="links-of-author-item"><a href="https://account.xbox.com/en-US/Profile?gamerTag=AlphaUnkX" title="Xbox â†’ https:&#x2F;&#x2F;account.xbox.com&#x2F;en-US&#x2F;Profile?gamerTag&#x3D;AlphaUnkX" rel="noopener me" target="_blank"><i class="fab fa-xbox fa-fw"></i>Xbox</a> </span><span class="links-of-author-item"><a href="http://steamcommunity.com/id/AlphaUnkX" title="Steam â†’ http:&#x2F;&#x2F;steamcommunity.com&#x2F;id&#x2F;AlphaUnkX" rel="noopener me" target="_blank"><i class="fab fa-steam fa-fw"></i>Steam</a> </span><span class="links-of-author-item"><a href="https://music.163.com/#/user/home?id=3351145306" title="ç½‘æ˜“äº‘ â†’ https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;3351145306" rel="noopener me" target="_blank"><i class="fab fa-wyy fa-fw"></i>ç½‘æ˜“äº‘</a> </span><span class="links-of-author-item"><a href="https://open.spotify.com/user/314w37qisyw7vf62xra6udzbo42u" title="Spotify â†’ https:&#x2F;&#x2F;open.spotify.com&#x2F;user&#x2F;314w37qisyw7vf62xra6udzbo42u" rel="noopener me" target="_blank"><i class="fab fa-spotify fa-fw"></i>Spotify</a> </span><span class="links-of-author-item"><a href="https://www.acfun.cn/u/72243486" title="ACFUN â†’ https:&#x2F;&#x2F;www.acfun.cn&#x2F;u&#x2F;72243486" rel="noopener me" target="_blank"><i class="fab fa-acfun fa-fw"></i>ACFUN</a></span></div></div></div></div></aside></div><div class="main-inner post posts-expand"><div class="post-block"><article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://alphax.top/f0de0769/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="AlphaUnkX"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="AlphaUnkX."><meta itemprop="description" content=""></span><span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="name" content="Serveræ­å»ºè¿‡ç¨‹-8.Dockerä¸ªäººå¿ƒå¾— | AlphaUnkX."><meta itemprop="description" content=""></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Serveræ­å»ºè¿‡ç¨‹-8.Dockerä¸ªäººå¿ƒå¾—</h1><div class="post-meta-container"><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">å‘è¡¨äº</span> <time title="åˆ›å»ºæ—¶é—´ï¼š2025-08-06 22:16:39" itemprop="dateCreated datePublished" datetime="2025-08-06T22:16:39+08:00">2025-08-06</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">æ›´æ–°äº</span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-09-07 00:59:10" itemprop="dateModified" datetime="2025-09-07T00:59:10+08:00">2025-09-07</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-tags"></i> </span><span class="post-meta-item-text">åˆ†ç±»äº</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/tags/Server/" itemprop="url" rel="index"><span itemprop="name">Server</span></a> </span></span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Walineï¼š</span> <a title="waline" href="/f0de0769/#waline" itemprop="discussionUrl"><span class="post-comments-count waline-comment-count" data-path="/f0de0769/" itemprop="commentCount"></span></a></span></div></div></header><div class="post-body" itemprop="articleBody"><p>â€‹</p><span id="more"></span><h3 id="1-Dockerçš„åŸºæœ¬ä½¿ç”¨">1.Dockerçš„åŸºæœ¬ä½¿ç”¨</h3><p>å‚è€ƒé“¾æ¥ï¼š<br>1.<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av114759127008838">40åˆ†é’Ÿçš„Dockerå®æˆ˜æ”»ç•¥ï¼Œä¸€æœŸè§†é¢‘ç²¾é€šDocker</a><br>2.<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/av346862560">Dockeræ¦‚å¿µï¼Œå·¥ä½œæµå’Œå®è·µ - å…¥é—¨å¿…æ‡‚</a><br>3.<a target="_blank" rel="noopener" href="https://yeasy.gitbook.io/docker_practice">Docker â€” ä»å…¥é—¨åˆ°å®è·µ</a></p><p>åœ¨Dockerè¿˜æ²¡æœ‰å‡ºç°çš„æ—¶æœŸï¼Œä½¿ç”¨è£¸æœºç›´æ¥éƒ¨ç½²è½¯ä»¶æœåŠ¡ã€‚<br>è½¯ä»¶è¿è¡Œæ€»è¦åŸºäºä¸€äº›ç¯å¢ƒï¼Œè€Œæ¯ä¸ªè½¯ä»¶éœ€è¦çš„ç¯å¢ƒé…ç½®å¯èƒ½å„ä¸ç›¸åŒã€‚<br>å…ˆä¸è¯´é…ç¯å¢ƒæœ‰å¤šç—›è‹¦ï¼Œç”šè‡³æœ‰äº›è½¯ä»¶éœ€è¦åŒä¸€ä¸ªç¯å¢ƒçš„ä¸åŒç‰ˆæœ¬ï¼Œä¼šå¼•èµ·å†²çªã€‚<br>è€Œä¸”è¿ç§»æ–¹é¢ï¼Œä½ çš„è®¾å¤‡ä¸Šä¹Ÿè®¸èƒ½æ­£å¸¸è¿è¡Œè¿™ä¸ªè½¯ä»¶æœåŠ¡ï¼Œåˆ«çš„è®¾å¤‡ä¸Šç”±äºç¯å¢ƒå˜åŒ–ï¼Œè½¯ä»¶æœåŠ¡å°±æœ‰å¯èƒ½è¿è¡Œä¸äº†äº†ã€‚</p><p>å› æ­¤å¾ˆè‡ªç„¶çš„æƒ³å‡ºè™šæ‹ŸåŒ–çš„æ–¹æ¡ˆï¼Œå…ˆæŠŠè½¯ä»¶æœåŠ¡éœ€è¦çš„ç¯å¢ƒå’Œè½¯ä»¶ä¸€èµ·æ‰“åŒ…ï¼Œè¿è¡Œåœ¨ä¸€ä¸ªç‹¬ç«‹çš„è™šæ‹ŸåŒ–ç¯å¢ƒï¼Œæ–¹ä¾¿è½¯ä»¶çš„éƒ¨ç½²å’Œè¿ç§»ã€‚<br>ä½†ä¼ ç»Ÿçš„è™šæ‹ŸåŒ–ï¼Œæ˜¯ç›´æ¥æ¨¡æ‹Ÿå‡ºä¸€å¥—å®Œæ•´çš„ç¡¬ä»¶å’Œä¸€å¥—å®Œæ•´çš„æ“ä½œç³»ç»Ÿå†…æ ¸ã€‚<br>å¯¹äºéƒ¨ç½²è½¯ä»¶æ¥è¯´ï¼Œå¾ˆå¤šæ—¶å€™éƒ½ä¸éœ€è¦è¿™ä¹ˆå®Œæ•´çš„è™šæ‹ŸåŒ–ï¼ŒåŒæ—¶è¿™ç§è™šæ‹ŸåŒ–çš„æ€§èƒ½å¼€é”€å¤ªå¤§ã€‚</p><p>Linuxå†…æ ¸æ”¯æŒæ“ä½œç³»ç»Ÿå±‚é¢çš„è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ï¼ˆè¿™åŸºäº<code>cgroup</code> , <code>namespace</code>ç­‰ç‰¹æ€§ï¼‰<br>åœ¨è¿™åŸºç¡€ä¸Šï¼Œdockeråšåˆ°äº†æ¯ä¸ªè™šæ‹Ÿçš„å®¹å™¨ï¼Œå…±ç”¨åŒä¸€ä¸ªç³»ç»Ÿå†…æ ¸ï¼ˆä¹Ÿå°±æ˜¯å®¿ä¸»æœºçš„å†…æ ¸ã€‚ï¼‰<br>åŒæ—¶dockerä¹Ÿæ²¡æœ‰è¿›è¡Œç¡¬ä»¶çš„è™šæ‹Ÿï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨å®¿ä¸»æœºçš„ç¡¬ä»¶ã€‚<br>è¿è¡Œçš„æ¯ä¸ªå®¹å™¨ï¼Œå°±åƒæ˜¯å®¿ä¸»æœºä¸‹ä¸€ä¸ªä¸€ä¸ªçš„ç‹¬ç«‹è¿›ç¨‹ã€‚<br>ç›¸è¾ƒäºä¼ ç»Ÿçš„è™šæ‹ŸåŒ–å¤§å¤§é™ä½äº†æ€§èƒ½å¼€é”€ï¼ŒåŒæ—¶è¿™ç§è™šæ‹ŸåŒ–çš„ç»“æ„æ›´åŠ çŸ­å°ç²¾æ‚ã€‚</p><p>è™½ç„¶è¯´å…±ç”¨å®¿ä¸»æœºçš„ç³»ç»Ÿå†…æ ¸ï¼Œä½†ä½ å¯èƒ½å‘ç°ä¸åŒå®¹å™¨å†…çš„Linuxå‘è¡Œç‰ˆä¸åŒã€‚<br>å…¶å®è¿™åªä»£è¡¨äº†ç”¨æˆ·ç©ºé—´ï¼Œå®é™…ä¸Šè¿˜æ˜¯åŒä¸€ä¸ªå®¿ä¸»æœºå†…æ ¸ã€‚</p><p>æ€»ç»“æ¥è®²ï¼ŒDockeræœ‰å‡ ä¸ªå¥½å¤„ï¼š<br>1.æ€§èƒ½æŸè€—ä½ï¼Œèµ„æºåˆ©ç”¨ç‡é«˜ï¼Œæ¯”ä¼ ç»Ÿè™šæ‹ŸåŒ–é«˜æ•ˆå¾—å¤šã€‚ï¼ˆä¸€èˆ¬æ¥è¯´æ€§èƒ½è¡¨ç°æ¥è¿‘åŸç”Ÿï¼‰<br>2.å¼€ç®±å³ç”¨ï¼Œä¸Šæ‰‹ç®€å•ï¼Œé•œåƒç”Ÿæ€å¥½ï¼ˆé€šè¿‡ç¼–å†™<code>Dockerfile</code>æˆ–è€…æ‹¿åˆ°åˆ«äººé¢„å…ˆæ„å»ºå¥½çš„é•œåƒï¼Œå¯ä»¥å¿«é€Ÿéƒ¨ç½²ç›´æ¥å¯ç”¨çš„æœåŠ¡ï¼‰<br>3.æä¾›äº†ä¸€è‡´çš„è¿è¡Œç¯å¢ƒï¼Œæ‰“åŒ…è¿ç§»å®¹å™¨å’Œé•œåƒæ–¹ä¾¿ã€å¿«é€Ÿã€‚<br>4.æ¯ä¸ªå®¹å™¨ä¹‹é—´ç‹¬ç«‹éš”ç¦»å¼€æ¥ï¼Œæ—¢ä¿è¯äº†å®¹å™¨å†…è¿è¡ŒæœåŠ¡ä¸å—å¹²æ‰°ï¼Œä¹Ÿä¸€å®šç¨‹åº¦ä¸Šä¿éšœäº†å®‰å…¨ã€‚</p><p>Dockeræœ‰ä¸¤ä¸ªæ¦‚å¿µï¼Œä¸€ä¸ªæ˜¯é•œåƒä¸€ä¸ªæ˜¯å®¹å™¨ã€‚<br>é•œåƒç±»ä¼¼äºæ¨¡æ¿ï¼Œäº‹å…ˆå®šä¹‰å¥½äº†ä¸€å¥—å®Œæ•´çš„åº”ç”¨ç¨‹åºè¿è¡Œç¯å¢ƒï¼ŒåŒ…æ‹¬ä»£ç ã€åº“ã€ä¾èµ–å’Œé…ç½®ã€‚<br>è€Œå®¹å™¨å…¶å®å°±æ˜¯åŸºäºé•œåƒæ‰€åˆ›å»ºçš„ä¸€ä¸ªå…·è±¡çš„å®ä¾‹ã€‚åƒæ˜¯æ ¹æ®å›¾çº¸æ¥æ„å»ºå‡ºçœŸæ­£çš„æˆ¿å­ã€‚<br>å¯èƒ½å¬èµ·æ¥æ¯”è¾ƒéš¾ç†è§£ï¼Œä¸è¿‡çœŸæ­£ä½¿ç”¨èµ·æ¥åº”è¯¥å°±é©¬ä¸Šæ‡‚äº†ã€‚</p><p>å…³äºé•œåƒå’Œå®¹å™¨æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„çš„ï¼š<br>å®¹å™¨å’Œé•œåƒéƒ½æ˜¯é‡‡ç”¨äº†<strong>åˆ†å±‚å­˜å‚¨</strong>çš„ç»“æ„ã€‚å®¹å™¨å®é™…ä¸Šæ˜¯åœ¨é•œåƒçš„åŸºç¡€ä¸Šï¼Œåˆ›å»ºäº†ä¸€å±‚å¯å†™å±‚ã€‚<br>ä¸ºäº†é¿å…é•œåƒé—´å¼•ç”¨çš„ä¾èµ–é“¾è¿‡é•¿å’Œè™šæ‚¬é•œåƒã€‚ä¸è¦æŠŠç”Ÿæˆçš„å®¹å™¨å†æ¬¡æ„å»ºæˆé•œåƒï¼Œæ¥ç€å¾ªåºåå¤ã€‚<br>å»ºè®®ç›´æ¥ä½¿ç”¨Dockerfileï¼Œä¸€æ¬¡æ€§å®‰è£…å®Œæ‰€æœ‰æ‰€éœ€ä¾èµ–ï¼Œç›´æ¥æ„å»ºæˆä¸€ä¸ªé•œåƒï¼Œå‡å°‘ä¸­é—´å±‚ã€‚<br>åŒæ—¶å°½é‡ä¿æŒå¯å†™å±‚çš„æ— çŠ¶æ€æ€§ï¼Œå®¹å™¨å†…ä½¿ç”¨æ•°æ®å·æˆ–è€…ç»‘å®šå®¿ä¸»ç›®å½•ã€‚<br>å¯¹äºåˆ†å±‚å­˜å‚¨ï¼Œç›®å‰éœ€è¦ç†è§£çš„å°±è¿™ä¹ˆå¤šã€‚<br>æ›´å¤šæ·±å…¥å†…å®¹ç­‰åˆ°åˆå­¦ä¹‹åï¼Œæƒ³è‡ªå·±ç¼–å†™<code>Dockerfile</code>æ—¶å†æŸ¥çœ‹ã€‚</p><hr><h4 id="1-docker-pull">1.docker pull</h4><p>å®Œæ•´çš„å‘½ä»¤ç¤ºä¾‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull docker.io/library/nginx:latest</span><br></pre></td></tr></table></figure><p>å‡ ä¸ªå‚æ•°ä»‹ç»ï¼š<br><code>docker.io</code>ï¼šé»˜è®¤å¯¹åº”<code>Docker Hub</code>å®˜æ–¹ä»“åº“åœ°å€ï¼Œä¹Ÿå¯ä»¥æ›¿æ¢ä¸ºå…¶ä»–ä»“åº“åœ°å€ï¼ˆä¾‹å¦‚å›½å†…çš„ä¸€äº›é•œåƒæºï¼‰ã€‚<br><code>library</code>ï¼šé»˜è®¤å¯¹åº”å®˜æ–¹é•œåƒçš„å‘½åç©ºé—´ï¼Œç›¸å½“äºä½œè€…åã€‚<br><code>é•œåƒå†’å·åçš„éƒ¨åˆ†</code>ï¼šç”¨äºæŒ‡å®šé•œåƒçš„æ ‡ç­¾ï¼ˆ<code>tag</code>ï¼‰ï¼Œå¸¸ç”¨æ¥è¡¨ç¤ºç‰ˆæœ¬å·ï¼ˆå¦‚<code>nginx:1.25</code>ï¼‰ï¼Œé»˜è®¤å€¼ä¸º<code>latest</code>ã€‚æ„ä¸ºæœ€æ–°ç‰ˆæœ¬ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull nginx</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºï¼šåœ¨Dockerå®˜æ–¹ä»“åº“çš„å®˜æ–¹å‘½åç©ºé—´å†…ï¼Œä¸‹è½½Nginxçš„æœ€æ–°ç‰ˆæœ¬ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull cloudreve/cloudreve</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºï¼šåœ¨Dockerå®˜æ–¹ä»“åº“çš„<code>Cloudreve</code>ä½œè€…åï¼Œä¸‹è½½<code>Cloudreve</code>çš„æœ€æ–°ç‰ˆæœ¬ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull docker.xuanyuan.me/mysql</span><br></pre></td></tr></table></figure><p>è¡¨ç¤ºï¼šåœ¨<code>docker.xuanyuan.me</code>è¿™ä¸ªéå®˜æ–¹ä»“åº“çš„å®˜æ–¹å‘½åç©ºé—´å†…ï¼Œä¸‹è½½<code>mysql</code>çš„æœ€æ–°ç‰ˆæœ¬ã€‚<br>è¿™ä¹Ÿæ˜¯ä¸€ç§ä¸´æ—¶æ¢æºçš„åŠæ³•ï¼ŒæŠŠä»“åº“åœ°å€æŒ‡å®šä¸ºå›½å†…çš„é•œåƒæºã€‚</p><h4 id="2-docker-imagesï¼ˆç­‰åŒäºdocker-image-lsï¼‰">2.docker imagesï¼ˆç­‰åŒäº<code>docker image ls</code>ï¼‰</h4><p>åˆ—å‡ºæœ¬åœ°æ‰€å­˜çš„é•œåƒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY                             TAG       IMAGE ID       CREATED       SIZE</span><br><span class="line">docker.m.daocloud.io/node              latest    0c7eb8906f06   7 days ago    1.14GB</span><br><span class="line">nginx                                  latest    ad5708199ec7   3 weeks ago   192MB</span><br></pre></td></tr></table></figure><h4 id="3-docker-tag">3.docker tag</h4><p>ä¸Šé¢<code>docker images</code>ä¸­ï¼Œç»è¿‡ä¸´æ—¶ä»£ç†ä¸‹è½½çš„é•œåƒï¼Œ<code>REPOSITORY</code>åå˜å¾—æ¯”å®˜æ–¹ä»“åº“çš„é•¿çš„å¤šã€‚<br>æƒ³è¦é‡å‘½åé•œåƒï¼Œå¯ä»¥ä½¿ç”¨<code>docker tag</code>å‘½ä»¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker tag docker.m.daocloud.io/node node</span><br></pre></td></tr></table></figure><p>å’Œä¸Šé¢ç±»ä¼¼çš„ï¼Œå¦‚æœé•œåƒååä¸å†™<code>tag</code>ï¼Œé»˜è®¤ä¸º<code>latest</code>ã€‚</p><p><strong>éœ€è¦æ³¨æ„</strong>ï¼š<code>tag</code>å‘½ä»¤åªæ˜¯æ–°å¢äº†ä¸€ä¸ªæ ‡ç­¾æŒ‡å‘è¿™ä¸ªé•œåƒã€‚<br>ç°åœ¨å…¶å®<code>node:latest</code> å’Œ <code>docker.m.daocloud.io/node:latest</code>è¿™ä¸¤ä¸ª<code>tag</code>éƒ½æŒ‡å‘äº†åŒä¸€é•œåƒã€‚ï¼ˆå³<code>IMAGE ID</code>ä¸º<code>0c7eb8906f06</code>çš„é•œåƒï¼‰éœ€è¦çš„è¯ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤æŠŠåŸæ¥çš„é•¿<code>tag</code>åˆ é™¤ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rmi docker.m.daocloud.io/node</span><br><span class="line">Untagged: docker.m.daocloud.io/node:latest</span><br></pre></td></tr></table></figure><p>å®é™…ä¸Šæ‰§è¡Œå‘½ä»¤åï¼Œ<code>Docker</code>é¦–å…ˆä¼šæŠŠè¿™ä¸ª<code>tag</code>åˆ é™¤ã€‚å¦‚æœè¿˜æœ‰å…¶ä»–<code>tag</code>æŒ‡å‘åŒä¸€ä¸ªé•œåƒIDï¼Œé‚£é•œåƒæ–‡ä»¶è¿˜ä¼šä¿ç•™ã€‚<br>å½“è¿™ä¸ªé•œåƒçš„æ‰€æœ‰<code>tag</code>éƒ½æ²¡äº†ï¼Œä¸”æ²¡æœ‰å®¹å™¨ä¾èµ–å®ƒï¼Œè¿™ä¸ªé•œåƒIDå°±ä¼šçœŸæ­£ä»ç£ç›˜ä¸Šæ¸…å‡ºã€‚</p><h4 id="4-docker-run">4.docker run</h4><p>å¸¸è§„å‘½ä»¤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run --network host --name atest -itd nginx</span><br></pre></td></tr></table></figure><p>docker start/stop/restart</p><p>docker ps</p><p>psä¸­ï¼Œå®¹å™¨çš„å¯åŠ¨å‘½ä»¤æ˜¯åœ¨å“ªé‡Œç¼–å†™çš„ï¼ŒDockerfileå—ï¼Ÿ<br>psä¸­ï¼Œå®¹å™¨çš„å¯åŠ¨å‘½ä»¤ä¸­çš„å½“å‰ç»ˆç«¯ï¼ˆæ¯”å¦‚shã€bashï¼‰å¦‚ä½•è¿›å…¥ã€‚</p><p>docker runä¸­æŒ‡å®š -argä»£ç†å˜é‡æ˜¯å¦‚ä½•åœ¨å®¹å™¨å†…ç”Ÿæ•ˆçš„ï¼ŸæŒ‡å®šåœ¨æŸä¸ªç»ˆç«¯ï¼ˆæ¯”å¦‚shå’Œbashï¼‰ç”Ÿæ•ˆå—ï¼Ÿ</p><p>docker log ä¸­è®°å½•çš„å®¹å™¨æ—¥å¿—æ˜¯ä»å“ªæ¥çš„ï¼Œç»ˆç«¯è¾“å‡ºçš„ä¿¡æ¯å—ï¼Ÿ</p><p>docker ps -a</p><p>docker rename</p><p>docker exec</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œä½¿ç”¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker exec -it node bash</span><br></pre></td></tr></table></figure><p>çš„è¯ï¼Œæ‰“å¼€<code>top</code>ç›‘è§†ï¼Œä¼šå‘ç°åˆ›å»ºäº†ä¸€ä¸ªæ–°çš„bashç»ˆç«¯ã€‚<br>è¿™ä¹Ÿæ­£æ˜¯linuxçš„ç‰¹æ€§ï¼Œç”¨æˆ·å¯ä»¥åŒæ—¶æ‰“å¼€å¹¶ç‹¬ç«‹æ“ä½œå¤šä¸ªç»ˆç«¯ï¼Œè€Œäº’ä¸å½±å“ã€‚</p><p>docker copy</p><p>docker build</p><p>docker push</p><p>docker rm/rmi</p><hr><p>å…ˆè¯´è¯´ä½¿ç”¨<code>dockeré•œåƒ</code>æ­å»º<code>tailscale</code>çš„<code>derp</code>ä¸­è½¬æœåŠ¡å™¨ã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š<br>1.<a target="_blank" rel="noopener" href="https://icloudnative.io/posts/custom-derp-servers/#%E4%BD%BF%E7%94%A8%E7%BA%AF-ip">https://icloudnative.io/posts/custom-derp-servers/#ä½¿ç”¨çº¯-ip</a><br>2.<a target="_blank" rel="noopener" href="https://github.com/yangchuansheng/ip_derper">https://github.com/yangchuansheng/ip_derper</a><br>3.<a target="_blank" rel="noopener" href="https://blog.csdn.net/god_sword_/article/details/129353427">https://blog.csdn.net/god_sword_/article/details/129353427</a><br>4.<a target="_blank" rel="noopener" href="https://neucrack.com/p/286">https://neucrack.com/p/286</a><br>5.<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/1041557640">ä»¤äººå¤´ç–¼çš„ docker ä»£ç†é—®é¢˜ï¼Œæˆ‘æ•´ç†äº†è§£å†³æ–¹æ³•å’ŒéªŒè¯æ–¹æ¡ˆ</a></p><p>dockeréœ€è¦æ¢æºå’Œä»£ç†çš„ï¼Œä¿®æ”¹è¿™é‡Œï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/docker/daemon.json</span><br></pre></td></tr></table></figure><p>æ ¼å¼ç±»ä¼¼è¿™æ ·ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [</span><br><span class="line">    &quot;https://docker.xuanyuan.me&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;proxies&quot;: &#123;</span><br><span class="line">    &quot;http-proxy&quot;: &quot;http://127.0.0.1:7890&quot;,</span><br><span class="line">    &quot;https-proxy&quot;: &quot;http://127.0.0.1:7890&quot;,</span><br><span class="line">    &quot;no-proxy&quot;: &quot;localhost,127.0.0.0/8&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æœåªæ˜¯è°ƒæ•´jsonæ–‡ä»¶è€Œæ²¡æœ‰æ›´æ”¹systemdçš„é…ç½®æ–‡ä»¶ï¼Œåªéœ€è¦é‡å¯dockerå°±è¡Œäº†ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><p>å¦åˆ™ï¼Œåˆ™è¾“å…¥è¿™ä¸¤æ¡å‘½ä»¤è®©é…ç½®ç”Ÿæ•ˆã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl daemon-reload</span><br><span class="line">sudo systemctl restart docker</span><br></pre></td></tr></table></figure><p>è‹¥è¦æ£€æŸ¥ç”Ÿæ•ˆæƒ…å†µï¼Œå¯ä»¥æ‰§è¡Œ<code>docker info</code><br>åœ¨ä¿¡æ¯ä¸­æœ‰http proxyç­‰å­—çœ¼å°±æ˜¯æˆåŠŸäº†ã€‚</p><p>é…ç½®åæ‹‰å–é•œåƒå¯èƒ½ä¸€å¼€å§‹ä¼šEOFæŠ¥é”™ï¼Œå¤šæ‹‰å‡ æ¬¡å°±å¥½äº†ã€‚<br>docker pullå’Œ pushéƒ½å¯ä»¥ç”¨è¿™ä¸ªã€‚</p><p>å½“ç„¶ä¸€èˆ¬æ¥è¯´è®¾ç½®äº†ä»£ç†å°±ä¸è®¾ç½®å›½å†…é•œåƒæºï¼Œè®¾ç½®äº†å›½å†…é•œåƒæºå°±ä¸è®¾ç½®ä»£ç†ã€‚<br>å› ä¸ºä¸¤ä¸ªéƒ½è®¾ç½®çš„æƒ…å†µä¸‹ï¼Œå°±æ˜¯åœ¨å›½å†…é•œåƒæºå†…å¯»æ‰¾é•œåƒï¼Œæ¥ç€é€šè¿‡ä»£ç†æ‹‰å–åˆ°æœ¬åœ°ï¼Œçº¯ç²¹æ²¡å¿…è¦è¿™æ ·åšã€‚<br>ä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä¸è®¾ç½®å›½å†…é•œåƒæºï¼Œå› ä¸ºå›½å†…é•œåƒæºå¹¶ä¸ç¨³å®šï¼Œå“ªå¤©æ²¡äº†è¿˜å¾—å†æ‰¾ã€‚<br>ä»¥ä¸‹éƒ½ä»¥ä»£ç†é…ç½®ä¸ºä¸»ã€‚<br>è®¾ç½®äº†å¯ç”¨çš„å›½å†…é•œåƒæºï¼Œç­‰æ•ˆäºdaemon.json+å®¿ä¸»æœºç»ˆç«¯ä»£ç†è®¾ç½®ã€‚</p><p>docker buildåˆåˆ†ä¸¤ç§æƒ…å†µï¼Œç¬¬ä¸€ç§æ˜¯docker deamon pullå¤–éƒ¨é•œåƒï¼Œæ¯”å¦‚ç”¨FROM goç­‰åˆ«çš„é•œåƒï¼Œ<br>ç¬¬äºŒç§æƒ…å†µæ˜¯æ„å»ºçš„ä¸´æ—¶å®¹å™¨å†… å¦‚wgetä¸‹è½½githubæ–‡ä»¶ç­‰å¯èƒ½ã€‚<br>æ£€æŸ¥daemon.jsonæ˜¯å¦å¯¹ä¸¤ç§æœ‰ç”¨ï¼Œå¯ä»¥ç”¨curlç„¶ådockeræŸ¥çœ‹å®¹å™¨æ—¥å¿—çš„å½¢å¼ã€‚</p><p>å¦å¤–æ£€æŸ¥daemon.jsonæ˜¯å¦èƒ½ç›´æ¥ä½¿å¾—å®¹å™¨å†…æŒ‚åœ¨ä»£ç†ä¸Šï¼Œé¢æ˜¯ä¸æ˜¯å—äº†itdåå°è¿è¡Œçš„å½±å“ï¼Œä¸å¼€åå°d ç”¨åŸæœ¬çš„ç»ˆç«¯ç¨‹åºè¿›å»çœ‹çœ‹æœ‰æ²¡æœ‰ä»£ç†ã€‚</p><p>å¦å¤–æœ‰ä¸€ç§æƒ…å†µï¼ŒæœåŠ¡å™¨å¼€å¯äº†å…¬ç½‘ipv6çš„åœ°å€ï¼ˆæ¯”å¦‚è…¾è®¯äº‘çš„æœåŠ¡å™¨ï¼‰ï¼Œè€Œä¸€èˆ¬çš„ä»£ç†å·¥å…·åªä»£ç†V4ã€‚<br>docker buildæ‹‰å–é•œåƒçš„æ—¶å€™æŠ¥é”™ä¿¡æ¯é‡Œé¢æœ‰IPV6çš„åœ°å€ï¼Œåº”è¯¥å°±æ˜¯daemonä¼˜å…ˆä½¿ç”¨äº†v6åœ°å€ã€‚</p><p>å› æ­¤daemonè¿™æ ·è®¾ç½®ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;registry-mirrors&quot;: [</span><br><span class="line">    &quot;https://docker.xuanyuan.me&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;proxies&quot;: &#123;</span><br><span class="line">    &quot;http-proxy&quot;: &quot;http://127.0.0.1:7890&quot;,</span><br><span class="line">    &quot;https-proxy&quot;: &quot;http://127.0.0.1:7890&quot;,</span><br><span class="line">    &quot;no-proxy&quot;: &quot;localhost,127.0.0.0/8&quot;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;ipv6&quot;: false</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>docker buildçš„æ—¶å€™ä¼šç»ˆç«¯<br>ä¸è¦pullå†build</p><p>daemonä¸ä¼šå½±å“buld</p><p>config.jsonå¯¹åº”ä¼ è¿›å»å®¹å™¨å†…</p><p>networkäº†å°±ä¸ç”¨å†configï¼Œnetworkèƒ½ç›´æ¥ç»ˆç«¯ï¼Œä¸éœ€è¦å†configè®¾ç½®ã€‚å’Œrunåæ‰“å¼€çš„å®¹å™¨ä¸ä¸€æ ·ã€‚</p><p>docker build æ—¶å€™Fromé•œåƒçš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯è¿™éƒ¨åˆ†ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=&gt; [internal] load build definition from Dockerfile                                                               </span><br><span class="line">=&gt; =&gt; transferring dockerfile: 130B                                                                               </span><br><span class="line">=&gt; [internal] load metadata for docker.io/library/golang:latest                                                   </span><br><span class="line">=&gt; [internal] load .dockerignore                                                                                  </span><br><span class="line">=&gt; =&gt; transferring context: 2B                                                                                    </span><br><span class="line">=&gt; [1/3] FROM docker.io/library/golang:latest@sha256:5502b0e56fca23feba76dbc5387ba59c593c02ccc2f0f7355871ea9a085  </span><br><span class="line">=&gt; =&gt; resolve docker.io/library/golang:latest@sha256:5502b0e56fca23feba76dbc5387ba59c593c02ccc2f0f7355871ea9a085  </span><br></pre></td></tr></table></figure><p>å¦‚æœå›½å†…ç¯å¢ƒï¼Œä»€ä¹ˆä¹Ÿä¸åŠ¨çš„æƒ…å†µä¸‹ï¼Œå¤§æ¦‚ç‡æ˜¯åœ¨load metadataè¿™ä¸€è¡Œå°±ä¼šå¡ä½ã€‚</p><p>Buildåˆ†ä¸¤éƒ¨åˆ†ï¼š<br>FROM é•œåƒï¼Œload metadataè¿™äº›éƒ¨åˆ†åº”è¯¥ç®—æ˜¯dockerdçš„ï¼Œå› ä¸ºè¿™éƒ¨åˆ†åªéœ€è¦åœ¨<strong>é…ç½®å¥½daemon.json</strong>çš„å‰æä¸‹<br>ï¼ˆè®°å¾—docker infoæ£€æŸ¥ä¸€ä¸‹jsoné…ç½®æ–‡ä»¶ç”Ÿæ•ˆæ²¡ï¼‰<br>å°†å®¿ä¸»æœºçš„ç»ˆç«¯è®¾ç½®ä¸Šä»£ç†å˜é‡ï¼Œå°±å¯ä»¥æ­£å¸¸é€šè¿‡FROMè¿™ä¸€å…³ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=http://127.0.0.1:7890</span><br><span class="line">export https_proxy=http://127.0.0.1:7890</span><br><span class="line">export HTTP_PROXY=http://127.0.0.1:7890</span><br><span class="line">export HTTPS_PROXY=http://127.0.0.1:7890</span><br><span class="line">export ALL_PROXY=socks5h://127.0.0.1:7890</span><br><span class="line">export all_proxy=socks5h://127.0.0.1:7890</span><br><span class="line">export NO_PROXY=localhost,127.0.0.0/8,::1</span><br><span class="line">export no_proxy=localhost,127.0.0.0/8,::1</span><br></pre></td></tr></table></figure><p>å½“ç„¶ä½ å¦‚æœä¸æ˜¯è£¸æ ¸è¿è¡Œï¼Œæœ‰è‡ªåŠ¨åŒ–çš„å·¥å…·å·²ç»å¸®ä½ é…å¥½å˜é‡çš„è¯å°±ä¸ç”¨å¼„è¿™ä¸€æ­¥äº†ã€‚</p><p>å¦ä¸€éƒ¨åˆ†å°±æ˜¯buildåå¼€å¯çš„ä¸´æ—¶å®¹å™¨ï¼Œè¿™å…¶ä¸­ä¼šæ‰§è¡Œ<code>Dockerfile</code>ä¸­RUNç­‰å„ç§å‚æ•°ã€‚<br>docker run æ·»åŠ <code>--network host</code>å‚æ•°å·²ç»èµ·ä¸äº†ä½œç”¨äº†ï¼Œå¹¶ä¸èƒ½ä½¿å¾—ä¸´æ—¶å®¹å™¨å†…æˆåŠŸä½¿ç”¨åˆ°å®¿ä¸»æœºçš„ä»£ç†ã€‚</p><p>è¦ä¹ˆåœ¨<code>docker run</code>ä¸­ä½¿ç”¨<code>--build-arg</code>å‚æ•°ï¼Œè¦ä¹ˆåœ¨<code>~/.docker/config.json</code>é…ç½®æ–‡ä»¶ä¸‹è®¾ç½®ä»£ç†ã€‚<br>éƒ½èƒ½æŠŠä»£ç†å˜é‡ä¼ å…¥ä¸´æ—¶å®¹å™¨ä¸­ã€‚</p><p>è‡³äºä»£ç†å˜é‡çš„å€¼æ˜¯å¤šå°‘ï¼Œè¦çœ‹ä½ docker runæ·»ä¸æ·»åŠ <code>--network host</code>å‚æ•°<br>åŠ äº†çš„è¯å°±127.0.0.1ï¼Œä¸åŠ å°±æ˜¯dockerçš„è™šæ‹Ÿç½‘å€ã€‚</p><p>å‚è€ƒï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">docker build \</span><br><span class="line">  --build-arg http_proxy=http://127.0.0.1:7890 \</span><br><span class="line">  --build-arg https_proxy=http://127.0.0.1:7890 \</span><br><span class="line">  --build-arg HTTP_PROXY=http://127.0.0.1:7890 \</span><br><span class="line">  --build-arg HTTPS_PROXY=http://127.0.0.1:7890 \</span><br><span class="line">  --network host \</span><br><span class="line">  -t name .</span><br></pre></td></tr></table></figure><p>ä¸€èˆ¬æ¥è¯´ä¸Šé¢è™½ç„¶exportäº†å¾ˆå¤šå˜é‡åœ¨ç»ˆç«¯ï¼Œä½†æ˜¯dockerå®¹å™¨å†…éƒ¨ä¸€èˆ¬æ¥è¯´ç”¨ä¸åˆ°sockså’Œnoproxyå§ï¼Ÿ<br>æ ¹æ®è‡ªå·±æƒ…å†µæ¥è°ƒæ•´æœ€å¥½ã€‚</p><hr><br><hr><p>æˆ‘é€‰æ‹©cdåˆ°optç›®å½•ä¸‹ç¼–è¯‘æ–‡ä»¶ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /opt</span><br></pre></td></tr></table></figure><p>å…ˆæŠŠç›¸å…³æ–‡ä»¶gitä¸‹æ¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/yangchuansheng/ip_derper</span><br></pre></td></tr></table></figure><p>é‡Œé¢æœ‰å‚è€ƒé“¾æ¥<strong>1</strong>å¯¹åº”çš„ç”Ÿæˆè¯ä¹¦shè„šæœ¬å’ŒDockerfileã€‚</p><p>cdåˆ°gitä¸‹è½½çš„æ–‡ä»¶å¤¹å†…ï¼Œå³å’Œ<code>build_cert.sh</code>ã€<code>Dockerfile</code>çš„åŒçº§ç›®å½•ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ip_derper</span><br></pre></td></tr></table></figure><p>æ¥ç€git clone tailscaleä¸Šçš„å®˜æ–¹ä»“åº“</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/tailscale/tailscale</span><br></pre></td></tr></table></figure><p>å› ä¸ºDockerfileé‡Œé¢å†™çš„æ˜¯ADDå˜é‡ï¼Œè¦æŠŠå®¿ä¸»æœºä¸Šçš„tailscaleå¯¹åº”æ–‡ä»¶å¤åˆ¶è¿›dockerå®¹å™¨ç¼–è¯‘ã€‚æ‰€ä»¥å…ˆè¦æŠŠæ–‡ä»¶ä¸‹åˆ°å®¿ä¸»æœºã€‚</p><p>æ›´æ”¹cert.goæ–‡ä»¶ä»¥æ”¯æŒçº¯IP</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim tailscale/cmd/derper/cert.go</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°è¿™ä¸‰è¡Œï¼šï¼ˆå¤§æ¦‚åœ¨ç¬¬131è¡Œï¼‰</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if hi.ServerName != m.hostname &amp;&amp; !m.noHostname <span class="punctuation">&#123;</span></span><br><span class="line">                return nil<span class="punctuation">,</span> fmt.Errorf(<span class="string">&quot;cert mismatch with hostname: %q&quot;</span><span class="punctuation">,</span> hi.ServerName)</span><br><span class="line">        <span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><p>åˆ é™¤æˆ–è€…æ³¨é‡Šæ‰ã€‚</p><p>å›åˆ°<code>Dockerfile</code>ç›®å½•ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /opt/ip_derper</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨<code>docker</code>æ„å»ºé•œåƒ</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build --network host -t derp .</span><br></pre></td></tr></table></figure><p>ä¹‹å‰åœ¨daemon.jsonè®¾ç½®äº†æ¢æºå’Œä»£ç†ï¼Œbuildçš„æ—¶å€™å…¶å®ä¼šå¼€ä¸€ä¸ªä¸´æ—¶å®¹å™¨ï¼Œbuildçš„æ—¶å€™è®¾ç½®ç½‘ç»œæ¨¡å¼ä¸ºhostï¼Œç›´æ¥ç”¨å®¿ä¸»æœºçš„7890ä»£ç†ç«¯å£ï¼ŒåŠ å¿«ç¼–è¯‘ã€‚<br>ï¼ˆåˆ°æ—¶å€™è®°å¾—æµ‹è¯•ä¸€ä¸‹docker execè¿›å®¹å™¨ç»ˆç«¯èƒ½ä¸èƒ½ç”¨ä»£ç†ï¼‰</p><p>~./docker/config.jsonå’Œ/etc/docker/daemon.jsonè¿™ä¸¤ä¸ªè®¾ç½®ä»£ç†çš„åŒºåˆ«ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker run --network host --name derp -itd derp</span><br><span class="line">docker exec -it derp bash</span><br></pre></td></tr></table></figure><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/johnnyzen/p/18746970">https://www.cnblogs.com/johnnyzen/p/18746970</a></p></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Server/" rel="tag"><i class="fa fa-tag"></i> Server</a></div></footer></article></div><div class="comments" id="waline"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2022 â€“ <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="fa fa-heartsafas"></i> </span><span class="author" itemprop="copyrightHolder">AlphaUnkX</span></div></div></footer><div class="back-to-top" role="button" aria-label="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up fa-lg"></i> <span>0%</span></div><noscript><div class="noscript-warning">Theme NexT works best with JavaScript enabled</div></noscript><script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script><script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script><script src="/js/third-party/search/local-search.js"></script><script src="/js/third-party/fancybox.js"></script><script src="/js/third-party/pace.js"></script><script class="next-config" data-name="waline" type="application/json">{"lang":"zh-CN","enable":true,"serverURL":"waline.alphax.top","cssUrl":"https://unpkg.com/@waline/client@v2/dist/waline.css","commentCount":true,"pageview":false,"el":"#waline","comment":true,"libUrl":"//unpkg.com/@waline/client@v2/dist/waline.js","path":"/f0de0769/"}</script><link rel="stylesheet" href="https://unpkg.com/@waline/client@v2/dist/waline.css"><script>document.addEventListener("page:loaded",()=>{NexT.utils.loadComments(CONFIG.waline.el).then(()=>NexT.utils.getScript(CONFIG.waline.libUrl,{condition:window.Waline})).then(()=>Waline.init(Object.assign({},CONFIG.waline,{el:document.querySelector(CONFIG.waline.el)})))})</script><script src="https://cdn.jsdelivr.net/npm/darkmode-js@1.5.7/lib/darkmode-js.min.js"></script><script>var options={bottom:"64px",right:"unset",left:"32px",time:"0.5s",mixColor:"transparent",backgroundColor:"transparent",buttonColorDark:"#100f2c",buttonColorLight:"#fff",saveInCookies:!0,label:"ğŸŒ“",autoMatchOsTheme:!0};const darkmode=new Darkmode(options);(window.darkmode=darkmode).showWidget()</script></body></html>